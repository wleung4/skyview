{"version":3,"file":"main.js","mappings":"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","sources":["webpack://skyview/./src/scripts/airport.js","webpack://skyview/./src/scripts/flight.js","webpack://skyview/./src/scripts/map.js","webpack://skyview/./src/index.js"],"sourcesContent":["const airports = [];\nlet airportObj;\nexport const getAllAirports = async () => {\n\t// csv file row = \"country_code\",\"region_name\",\"iata\",\"icao\",\"airport\",\"latitude\",\"longitude\"\n\tconst res = await fetch('https://wleung4.github.io/skyview/iata-icao.csv');\n\tconst data = await res.text();\n\tconst rows = data.split('\\n').slice(1);\n\trows.forEach((ele)=>{\n\t\tconst row = ele.split(\",\");\n\t\tconst country_code = row[0].slice(1, row[0].length - 1);\n\t\tconst region_name = row[1].slice(1, row[1].length - 1);\n\t\tconst iata = row[2].slice(1, row[2].length - 1);\n\t\tconst icao = row[3].slice(1, row[3].length - 1);\n\t\tconst airport = row[4].slice(1, row[4].length - 1);\n\t\tconst latitude = row[5].slice(1, row[5].length - 1);\n\t\tconst longitude = row[6].slice(1, row[6].length - 2);\n\t\tairports.push({airport: airport,country_code: country_code, region_name: region_name, iata: iata, \n\t\t\ticao: icao, latitude: latitude, longitude: longitude});\n\t})\n\t// transform array of objects into single object where keys is the airport name\n\tairportObj = airports.reduce((obj, item) => Object.assign(obj, {[item.airport]:item}, {}));\n}\n\nexport const getAirportInfo = async(airportName) => {\n\tawait getAllAirports();\n\tfor(const airport in airportObj) {\n\t\tif (airport.toLowerCase() === airportName.toLowerCase()) {\n\t\t\treturn [airport, airportObj[airport].icao, airportObj[airport].latitude, airportObj[airport].longitude];\n\t\t}\n\t}\n\treturn undefined;\n}\n\nexport const search = async(input) => {\n\tawait getAllAirports();\n\tconst results = [];\n\tconst keys = Object.keys(airportObj).slice(7);\n\t// console.log('airportObj', airportObj);\n\tkeys.forEach(airport => {\n\t\tif(airport.toLowerCase().includes(input.toLowerCase())){\n\t\t\tresults.push(airport);\n\t\t}\n\t})\n\tif(results.length === 0) results.push('No Results Found')\n\treturn results;\t\n}\n\n","let allFlights;\nlet arrivalFlights;\nlet departureFlights;\nlet aircraftFlights;\nlet flightLocations;\n\nconst url = \"https://opensky-network.org/api/flights/\";\n\n// track gives back last reported location of an airplane\nexport const getFlightLocation = async(icao24, time = 0) => {\n\ttry {\n\t\tconst res = await fetch(`https://opensky-network.org/api/tracks/all?icao24=${icao24}&time=${time}` , {headers: {\n\t\t\t'Accept': 'application/json'\n\t\t}})\n\t\tif(res.ok) {\n\t\t\tconst data = await res.json();\n\t\t\treturn data.path;\n\t\t} else {\n\t\t\tthrow new Error('response not ok');\n\t\t}\n\t} catch(error) {\n\t\tconsole.error('Error fetching data', error);\n\t}\n}\n// Get all flights between time frame < 2 hrs\nexport const getAllFlights = async (begin, end)  => {\n\t// beginning and ending in unix time, seconds since epoch\n\ttry {\n\t\tconst res = await fetch(url + `all?begin=${begin}&end=${end}`, {headers: {\n\t\t\t'Accept': 'application/json'\n\t\t}});\n\t\tif(res.ok){\n\t\t\tconst data = await res.json();\n\t\t\tallFlights = data;\n\t\t\treturn data;\n\t\t} else {\n\t\t\tthrow new Error('response not ok');\n\t\t}\n\t} catch(error) {\n\t\tconsole.error('Error fetching data', error);\n\t}\n}\n\n// Get flight information for aircraft departed and arrived within time frame < 30 days, \nexport const getAircraft = async(icao24, begin, end) => {\n\ttry {\n\t\tconst res = await fetch(url + `aircraft?icao24=${icao24}&begin=${begin}&end=${end}`, {headers: {\n\t\t\t'Accept': 'application/json',\n\t\t}});\n\t\tif(res.ok) {\n\t\t\tconst data = await res.json();\n\t\t\taircraftFlights = data;\n\t\t\treturn data;\n\t\t} else {\n\t\t\tthrow new Error('response not ok');\n\t\t}\n\t} catch(error) {\n\t\tconsole.error('Error fetching aircraft', error);\n\t}\n}\n\n// Get all airport arrivals at specific airport, time frame < 1 week, arrival data from previous day or earlier\nexport const getAirportArrivals = async (airport, begin, end) => {\n\ttry {\n\t\tconst res = await fetch(url + `arrival?airport=${airport}&begin=${begin}&end=${end}`, {headers: {\n\t\t\t'Accept': 'application/json',\n\t\t}});\n\t\tif(res.ok) {\n\t\t\tconst data = await res.json();\n\t\t\tarrivalFlights = data;\n\t\t\treturn data;\n\t\t} else {\n\t\t\tthrow new Error('response not ok');\n\t\t}\n\t} catch(error) {\n\t\tconsole.error('Error fetching arrivals', error);\n\t}\n}\n\n// Get all flight depatures at specific airport, time frame < 1 week, ALWAYS UP TO DATE\nexport const getAirportDepartures = async (airport, begin, end) => {\n\ttry {\n\t\tconst res = await fetch(url + `departure?airport=${airport}&begin=${begin}&end=${end}`, {headers: {\n\t\t\t'Accept': 'application/json',\n\t\t}});\n\t\tif(res.ok) {\n\t\t\tconst data = await res.json();\n\t\t\tdepartureFlights = data;\n\t\t\treturn data;\n\t\t} else {\n\t\t\tthrow new Error('response not ok');\n\t\t}\n\t} catch(error) {\n\t\tconsole.error('Error fetching departures', error);\n\t}\n}\n\n// convert user input time in hrs\nexport const calculateTime = (time = 0) => {\n\treturn Math.floor(new Date() / 1000) - time * 3600;\n}\n\n\n\n","let g;\nlet projection;\nlet airportLocation;\nexport const addMap = (location, icao) => {\n\tconst height = 600;\n\tconst width = 800;\n\n\tconst svg = d3.select('#map')\n\t\t.append('svg')\n\t\t.attr('width', width)\n\t\t.attr('height', height)\n\n\tg = svg.append('g');\n\t\n\tconst handleZoom = (e) => {\n\t\tg.attr('transform', e.transform);\n\t}\n\n\tlet zoom = d3.zoom()\n\t\t.scaleExtent([1, 80])\n\t\t.translateExtent([[0, 0], [width, height]])\n\t\t.on('zoom', handleZoom);\n\t\n\tsvg.call(zoom);\n\n\tprojection = d3.geoMercator()\n\t\t.center([location[0], location[1]])\n\t\t.translate([width / 2, height / 2])\n\t\t.scale(120);\n\n\tzoom.scaleTo(svg, 20);\n\t\n\tconst path = d3.geoPath()\n\t\t.projection(projection);\n\t\n\td3.json('https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json')\n\t\t.then(data => {\n\t\t\tconst countries = topojson.feature(data, data.objects.countries);\n\t\t\tconst coordinates = projection(location);\n\t\t\tairportLocation = coordinates;\n\t\t\tg.selectAll('path')\n\t\t\t\t.data(countries.features)\n\t\t\t\t.enter()\n\t\t\t\t.append('path')\n\t\t\t\t.attr('d', path)\n\t\t\t\n\t\t\tg.selectAll('circle')\n\t\t\t\t.data(location)\n\t\t\t\t.enter()\n\t\t\t\t.append('circle')\n\t\t\t\t.attr('cx', coordinates[0])\n\t\t\t\t.attr('cy', coordinates[1])\n\t\t\t\t.attr('r', .25)\n\t\t\t\t.style('fill', 'yellow');\n\n\t\t\tg.selectAll('text')\n\t\t\t\t.data(location)\n\t\t\t\t.enter()\n\t\t\t\t.append('text')\n\t\t\t\t.attr('x', coordinates[0] + .5)\n\t\t\t\t.attr('y', coordinates[1])\n\t\t\t\t.text(icao)\n\t\t\t\t.style('font-size', '1px')\n\t\t\t\t.style('stroke', 'blue');\n\t\t});\t\n}\n\nexport const drawPath = async(path, plane) => {\n\t// [time, latitude, longitude, baro_altitude, true_track, on_ground]\n\tconst coordinates = [];\n\tcoordinates.push(airportLocation);\n\tconst waypoints = await path;\n\twaypoints.forEach(waypoint => {\n\t\tcoordinates.push(projection([waypoint[2], waypoint[1]]));\n\t})\n\t\n\t// path using line\n\tconst lineGenerator = d3.line()\n\t\t.x(d => d[0])\n\t\t.y(d => d[1]);\n\n\tg.append('path')\n\t\t.data([coordinates])\n\t\t.attr('fill', 'none')\n\t\t.style('stroke', '#9c180c')\n\t\t.style('stroke-width', 0.1)\n\t\t.attr('d', lineGenerator)\n\n\tconst lastLocation = coordinates[coordinates.length - 1];\n\tconst lastAngle = waypoints[waypoints.length - 1][4];\n\t//const landed = waypoints[waypoints.length - 1][5];\n\n\tg.append('image')\n\t\t.attr('xlink:href', '../../assets/plane.png')\n\t\t.attr('width', 1.5)\n\t\t.attr('height', 1.5)\n\t\t.attr('x', lastLocation[0] - .75)\n\t\t.attr('y', lastLocation[1] - .75)\n\t\t.attr('transform', `rotate(${lastAngle}, ${lastLocation[0]}, ${lastLocation[1]})`);\n\t\n\tg.append('text')\n\t\t.attr('x', lastLocation[0] + .75)\n\t\t.attr('y', lastLocation[1] + .75)\n\t\t.text(plane) // `${plane} landed: ${landed}`\n\t\t.style('font-size', '.75px')\n\t\t.style('stroke', 'purple');\n}","import { getAirportInfo, search } from './scripts/airport.js';\nimport { calculateTime, getAirportDepartures, getFlightLocation } from './scripts/flight.js';\nimport { addMap, drawPath } from './scripts/map.js';\n\nconst searchForm = document.querySelector(\".home-search\");\nconst searchValue = document.querySelector(\"#search\");\nconst searchResults = document.querySelector(\"#search-results\");\nconst flightTable = document.querySelector(\"#flight-table\");\nconst mainPage = document.querySelector(\".main-page\");\nconst background = document.querySelector(\"#background\");\nconst instructions = document.querySelector(\".instructions\");\nconst reset = document.querySelector(\".reset\");\nconst map = document.querySelector(\"#map\");\n\nlet departures;\nlet locations;\nlet airportName;\nlet timer = null;\nsearchValue.addEventListener(\"keyup\", () => {\n\tsearchResults.style.display = \"none\";\n\tinstructions.style.display = \"block\";\n\tclearTimeout(timer);\n\ttimer = setTimeout(async()=>{\n\t\tif(searchValue.value !== \"\") {\n\t\t\tinstructions.style.display = \"none\"\n\t\t\tconst matches = await search(searchValue.value);\n\t\t\taddResults(matches);\n\t\t}\n\t}, 500);\n}) \n\nreset.addEventListener(\"click\", (e) => {\n\te.preventDefault();\n\tmainPage.style.display = \"none\";\n\tmap.style.display = \"none\";\n\tsearchForm.style.display = \"flex\";\n\tbackground.style.display = \"inline\";\n\tsearchValue.value = \"\";\n\tsearchResults.style.display = \"none\";\n\tinstructions.style.display = \"block\";\n\treset.style.display = \"none\";\n\tflightTable.removeChild(flightTable.firstChild);\n\td3.select(\"#map\").select(\"svg\").remove();\n})\n\nsearchForm.addEventListener(\"submit\", async(e) => {\n\te.preventDefault();\n\n\tlet value = searchValue.value;\n\t// airport ICAO\n\tif(value === \"\") value = \"N/A\";\n\tlet airportInfo = await getAirportInfo(value);\n\twhile (!airportInfo) {\n\t\tairportInfo = await getAirportInfo(value);\n\t}\n\tairportName = airportInfo[0];\n\tconst airportICAO = airportInfo[1];\n\tconst airportLatitude = airportInfo[2];\n\tconst airportLongitude = airportInfo[3];\n\tsearchForm.style.display = 'none';\n\tmainPage.style.display = \"flex\";\n\tbackground.style.display = \"none\";\n\treset.style.display = \"block\";\n\tmap.style.display = \"block\"\n\n\t// 1 day = 86400, 1 hr = 3600\n\tdepartures = await getAirportDepartures(airportICAO, calculateTime(6), calculateTime());\n\t\n\t// callsign = Plane identifier i.e. DAL767\n\taddFlightTable(departures);\n\taddMap([airportLongitude, airportLatitude], airportICAO);\n});\n\nconst addFlightTable = async(info) => {\n\tlet table = document.createElement(\"table\");\n\tlet tableBody = document.createElement(\"tbody\");\n\n\t//top column name row\n\tconst colRow = document.createElement(\"tr\");\n\tcolRow.classList.add(\"header\");\n\tconst callsignCol = document.createElement(\"td\");\n\tcallsignCol.textContent = \"Plane\";\n\tconst departureTimeCol = document.createElement(\"td\");\n\tdepartureTimeCol.textContent = \"Time Departed\";\n\tconst departureAirportCol = document.createElement(\"td\");\n\tdepartureAirportCol.textContent = \"From\";\n\tconst arrivalAirportCol = document.createElement(\"td\");\n\tarrivalAirportCol.textContent = \"To\";\n\n\tcolRow.appendChild(callsignCol);\n\tcolRow.appendChild(departureTimeCol);\n\tcolRow.appendChild(departureAirportCol);\n\tcolRow.appendChild(arrivalAirportCol);\n\ttableBody.appendChild(colRow);\n\n\t// actual data\n\tfor(let i = 0; i < info.length; i++){\n\t\tconst row = document.createElement(\"tr\");\n\n\t\tconst callsign = document.createElement(\"td\");\n\t\tcallsign.textContent = info[i].callsign;\n\t\tcallsign.classList.add(\"clickable\");\n\n\t\t// allows clickable planes => gets location info about clicked plane\n\t\tcallsign.addEventListener(\"click\", async(e) => {\n\t\t\te.stopPropagation();\n\t\t\tlocations = getFlightLocation(info[i].icao24);\n\t\t\tif(locations !== 'No data found') drawPath(locations, callsign.textContent);\n\t\t})\n\n\t\tconst departureTime = document.createElement(\"td\");\n\t\tconst date = new Date(info[i].firstSeen * 1000).toString();\n\t\tdepartureTime.textContent = date.slice(0, 28);\n\n\t\tconst departureAirport = document.createElement(\"td\");\n\t\tdepartureAirport.textContent = info[i].estDepartureAirport;\n\n\t\tlet arrivalAirport = document.createElement(\"td\");\n\t\tif(info[i].estArrivalAirport === null){\n\t\t\tarrivalAirport.textContent = \"TBD\";\n\t\t} else {\n\t\t\tarrivalAirport.textContent = info[i].estArrivalAirport;\n\t\t}\n\n\t\trow.appendChild(callsign);\n\t\trow.appendChild(departureTime);\n\t\trow.appendChild(departureAirport);\n\t\trow.appendChild(arrivalAirport);\n\n\t\ttableBody.appendChild(row);\n\t}\n\ttable.appendChild(tableBody);\n\tflightTable.appendChild(table);\n\tflightTable.classList.add(\"table-style\");\n}\n\nconst addResults = (matches) => {\n\twhile(searchResults.firstChild){\n\t\tsearchResults.removeChild(searchResults.firstChild);\n\t}\n\tmatches.forEach(match => {\n\t\tconst result = document.createElement(\"div\");\n\t\tresult.textContent = match;\n\t\tresult.addEventListener(\"click\", (e)=> {\n\t\t\te.stopPropagation();\n\t\t\tsearchValue.value = result.textContent;\n\t\t});\n\t\tsearchResults.appendChild(result);\n\t});\n\tsearchResults.style.display = \"block\";\n}\n"],"names":["airports","airportObj","getAllAirports","async","res","fetch","text","split","slice","forEach","ele","row","country_code","length","region_name","iata","icao","airport","latitude","longitude","push","reduce","obj","item","Object","assign","getAirportInfo","toLowerCase","airportName","departureFlights","getFlightLocation","icao24","time","arguments","undefined","headers","ok","json","path","Error","error","console","calculateTime","Math","floor","Date","g","projection","airportLocation","drawPath","plane","coordinates","waypoints","waypoint","lineGenerator","d3","line","x","d","y","append","data","attr","style","lastLocation","lastAngle","searchForm","document","querySelector","searchValue","searchResults","flightTable","mainPage","background","instructions","reset","map","departures","locations","timer","addEventListener","display","clearTimeout","setTimeout","value","matches","results","keys","includes","input","search","addResults","e","preventDefault","removeChild","firstChild","select","remove","airportInfo","airportICAO","airportLatitude","airportLongitude","begin","end","getAirportDepartures","addFlightTable","addMap","location","svg","zoom","scaleExtent","translateExtent","on","transform","call","geoMercator","center","translate","width","height","scale","scaleTo","geoPath","then","countries","topojson","feature","objects","selectAll","features","enter","table","createElement","tableBody","colRow","classList","add","callsignCol","textContent","departureTimeCol","departureAirportCol","arrivalAirportCol","appendChild","i","info","callsign","stopPropagation","departureTime","date","firstSeen","toString","departureAirport","estDepartureAirport","arrivalAirport","estArrivalAirport","match","result"],"sourceRoot":""}